from sage.all import*
from Crypto.Util.number import*
import sys
sys.path.append("../../../../Tools/coppersmith")
from coppersmith_multivariate_heuristic import coppersmith_multivariate_heuristic

n = 166214209617867965806368688332023171741655390617888997581977346865257328795957647799089848909405765358871252195355159334899572987590788180953770521820431390128254669213581349353158433075934105178167840727455957060712076921804146382136454228132540968166540240674620728552575359133149027386154277800283910417917
m1 = 144599695593938942954284388990862735163277176341313128443225857073404381276695986119558503396857066021738795458528976026293879106654171684563598640742291266437656993799201446058129902030472925028428585681055562475305761409778084434903201944204147641134889223913490884220219907184823032254636386413327028228570
# m2 = -m1%n
c = (pow(m1, 2, n))
# print(pow(m2, 2, n))
x, k = PolynomialRing(Zmod(n), "x, k").gens()

f = x**2 - c + k*n
bnd = 2**128
ans = coppersmith_multivariate_heuristic(f, [bnd, bnd], 1.0)[0]
res =ans
print(res)
# a
res = long_to_bytes(res[0]).hex()
print(res)
